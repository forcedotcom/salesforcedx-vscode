---
title: 保存時のデプロイ
lang: ja
---

## 概要

ローカルのソースファイルを保存するときはいつでも、変更した内容をデフォルトの組織にすぐにデプロイできるようにすることができます。この機能は、さまざまなユーザインターフェースや機能的な動作を試しているとき、または Apex クラスの動作をデバッグしているときに便利です。

保存時のデプロイを有効にするには、以下のようにします。

- `.vscode/settings.json` ファイルに `"salesforcedx-vcode-core.push-or-deploy-on-save.enabled": true` を追加します。
- または、ワークスペースの設定を更新します。
  - **[File \(ファイル\)]** > **[Preferences \(基本設定\)]** > **[Settings \(設定\)]** \(Windows、Linux\) または **[Code \(コード\)]** > **[Preferences \(基本設定\)]** > **[Settings \(設定\)]** \(macOS\) を選択します。
  - Salesforce Feature Previews で、`Push-or-deploy-on-save: Enabled` をチェックします。

![保存時デプロイの設定](./images/deploy-on-save.png)

> 保存時のデプロイを有効にする際は、作業中のすべての Salesforce プロジェクト (ユーザ設定) でグローバルに有効にするのではなく、プロジェクトレベル (ワークスペース設定) で有効にすることをお勧めします。大規模なサンドボックスで作業している間は、他の開発者による変更を誤って上書きしてしまわないように、注意して保存時のデプロイを有効にしてください。

## 仕組み

プロジェクトで保存時のデプロイを有効にした場合:

- 1 度につき、1 回のデプロイが実行されます。

- デプロイ中に保存されたファイルは、デプロイキューに追加されます。

- 現在のデプロイが完了すると、キューに入っているファイルを含む新しいデプロイが開始されます。これにより、デプロイの数を最小限に抑え、パフォーマンスを向上させることができます。

- アクティブなデプロイがなく、デプロイのためにファイルがキューに入っていない場合、ファイルの保存するとただちにデプロイが開始されます。

スクラッチ組織で作業しているときに保存時のデプロイを有効にすると、拡張機能のコンテキストはパッケージ開発モデルになります。つまり、ファイルを保存するたびに **SFDX: デフォルトのスクラッチ組織にソースをプッシュ (SFDX: Push Source to Default Scratch Org)** が起動し、`force:source:push` が実行されます。ソース追跡されていない組織で動作する、組織開発モデルでは、ファイルを保存するたびに **SFDX: 組織へソースをデプロイ (SFDX: Deploy Source to Org)** が起動し、`force:source:deploy` が実行されます。
